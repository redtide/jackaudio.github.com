<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8' />
        <meta name="description" content="JACK Audio Connection Kit | " />
        <link rel="stylesheet" type="text/css" media="screen" href="/jackaudio.github.com/assets/css/style.css">
        <link rel="alternate" type="application/atom+xml" href="/jackaudio.github.com/atom.xml" title="JACK Audio News">
        <title>JACK2 v1.9.19 release | JACK Audio Connection Kit</title>
        <!-- Favicon Generator Icons -->
        <link rel="apple-touch-icon" sizes="180x180" href="/jackaudio.github.com/assets/icons/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/jackaudio.github.com/assets/icons/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/jackaudio.github.com/assets/icons/favicon-16x16.png">
        <link rel="manifest" href="/jackaudio.github.com/assets/icons/site.webmanifest">
        <link rel="shortcut icon" href="/jackaudio.github.com/assets/icons/favicon.ico">
        <meta name="msapplication-TileColor" content="#212121">
        <meta name="msapplication-config" content="/jackaudio.github.com/assets/icons/browserconfig.xml">
        <meta name="theme-color" content="#212121">
    </head>
    <body>
        <!-- HEADER -->
        <div id="header_wrap" class="outer">
            <header class="inner">
                <a id="forkme_banner" href="https://github.com/jackaudio">View on GitHub</a>
                <a href="/jackaudio.github.com/">
                    <img src="/jackaudio.github.com/assets/images/logo.png"
                        alt="JACK Logo - Home" class="img-fluid">
                </a>
                <nav>
                    <a href="/jackaudio.github.com/"> Home </a> |
                    <a href="/jackaudio.github.com/news/"> News </a> |
                    <a href="/jackaudio.github.com/applications/"> Applications </a> |
                    <a href="/jackaudio.github.com/faq/"> FAQ </a> |
                    <a href="https://github.com/jackaudio/jackaudio.github.com/wiki"> WIKI </a> |
                    <a href="/jackaudio.github.com/api/"> API </a> |
                    <a href="/jackaudio.github.com/downloads/"> Downloads </a> |
                    <a href="/jackaudio.github.com/community/"> Community Network </a>
                </nav>
            </header>
        </div>
        <!-- MAIN CONTENT -->
        <div id="main_content_wrap" class="outer">
            <section id="main_content" class="inner">
                    <h2>JACK2 v1.9.19 release</h2>
    <p><strong>
        Posted on <time datetime="1626442867"
        >
        July 16, 2021 13:41</time>
                    by <a href="https://github.com/falkTX">falkTX</a>
            </strong></p>
    <div class="post">
        <article><p>A new version of JACK2 has just been released.<br/>
You can grab the latest release source code at
<a href="https://github.com/jackaudio/jack2/releases">https://github.com/jackaudio/jack2/releases</a> and macOS/Windows installers at
<a href="https://github.com/jackaudio/jack2-releases/releases">https://github.com/jackaudio/jack2-releases/releases</a>.</p>
<p>This release focuses on 2 main things: <code>jack_position_t::tick_double</code> addition and forced alignment of a few internal data structures.
A few other fixes were made as contributed by developers.</p>
<p>This relase adds <code>tick_double</code> to the <code>jack_position_t</code> struct and <code>JackTickDouble</code> as a validation flag for it.
Since older versions of JACK do not expose this variable, the macro <code>JACK_TICK_DOUBLE</code> is provided, which can be used as build-time detection.<br/></p>
<p>The alignment change is because the packed structure layouts as used in JACK2 need to be naturally aligned in order to be accessed atomically in some systems.
A non-aligned read or write can result in a &quot;Bus error&quot;, which brings down jackd.
This seems to only be relevant on certain ARM systems, as JACK2 was obviously working before this change for most people.<br/>
As a consequence of this change, the internal protocol version was bumped to 9, which <b>requires the restart of the JACK server</b> after the update.</p>
<p>The official changelog is:</p>
<ul>
<li>Add jack_position_t::tick_double, and flags around it</li>
<li>Add zalsa &quot;-w&quot; argument to wait for soundcard to be available</li>
<li>Bump internal protocol version to 9 (due to struct alignment)</li>
<li>Fix alignment of fields for atomic accesses</li>
<li>Fix build for platforms needing __STDC_FORMAT_MACROS</li>
<li>Fix compilation of documentation</li>
</ul>
<p>External changes, related to macOS/Windows installer:</p>
<ul>
<li>Fix macOS microphone permissions on qjackctl macOS app bundle</li>
<li>Update qjackctl to 0.9.4</li>
</ul>
<p>Now, for the rationale behind the transport <code>tick_double</code> API update:</p>
<p>When using JACK transport to sync between clients with precise timing requirements (such as MIDI sequencers) rounding errors would accumulate and eventually make the separate clients out of sync.<br/>
This was observed in Carla and mod-host, which use audio plugins as JACK clients.
Some MIDI plugins could miss notes due to rounding errors.
This change has been deployed in MOD Devices for a couple of releases already and it is known to work (that is, it corrects the situation).</p>
<p>There were discussions on IRC about this potentially be unnecessary, that clients can just use <code>bar_start_tick</code> to store the non-integer part of the tick.<br/>
While the idea could work in theory, supporting it turns out to be non-trivial and from all applications that I have tested none implemented this part correctly.<br/>
Some applications do not set <code>bar_start_tick</code> at all, even though they can be run as transport master.</p>
<p>So since the transport API has padding members available for use and it has been unchanged for several years (so there won't be a need to add more fields in the short or middle term), well let's just go for it.</p>
<p>Here is example code for transport-listening clients:</p>
<pre><code class="hljs language-cpp"><span class="hljs-keyword">double</span> tick;
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> JACK_TICK_DOUBLE</span>
<span class="hljs-keyword">if</span> (pos.valid &amp; JackTickDouble)
    tick = pos.tick_double;
<span class="hljs-keyword">else</span>
#endif
    tick = pos.tick;</code></pre></article>
    </div>
            </section>
        </div>
<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
    <footer class="inner">
        <p class="copyright" style="text-align:left">Slate theme maintained by
            <a href="https://github.com/pages-themes">pages-themes</a>
            <span style="float:right">This site is open source.
                <a href="https://github.com/jackaudio/jackaudio.github.com/edit/master/_posts/2021-07-16-jack2-v1919-release.md">
                Improve this page</a>
            </span>
        </p>
    </footer>
</div>
    </body>
</html>
